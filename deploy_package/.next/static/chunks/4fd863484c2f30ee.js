(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,a,t)=>{a.exports=e.r(76562)},31278,e=>{"use strict";let a=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>a],31278)},42545,e=>{"use strict";e.i(47167),e.s(["BASE_PATH",0,"/gerador-matricula"],42545)},28890,e=>{"use strict";var a=e.i(43476),t=e.i(932),s=e.i(17255),r=e.i(18566),l=e.i(71645),i=e.i(75254);let d=(0,i.default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),o=(0,i.default)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var n=e.i(31278);let c=(0,i.default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),x=(0,i.default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),m=(0,i.default)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),u=(0,i.default)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]),h=(0,i.default)("graduation-cap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]),p=(0,i.default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var f=e.i(22016),b=e.i(42545);function g({params:e}){let t,i,{data:g,status:j}=(0,s.useSession)(),v=(0,r.useRouter)(),N=(0,l.use)(e).cpf,[k,w]=(0,l.useState)(null),[A,C]=(0,l.useState)(!0),[M,T]=(0,l.useState)(""),[D,S]=(0,l.useState)(!1),[E,z]=(0,l.useState)(!1);(0,l.useEffect)(()=>{"unauthenticated"===j&&v.push("/login")},[j,v]),(0,l.useEffect)(()=>{N&&"authenticated"===j&&e();async function e(){try{let e=await fetch(`${b.BASE_PATH}/api/students/${N}`);if(!e.ok)throw Error("Student not found");let a=await e.json();w(a.data)}catch(e){T("Aluno não encontrado ou erro na busca.")}finally{C(!1)}}},[N,j]);let R=async(e=!1)=>{if(k){if("ATIVO"!==k["Situação Cadastral"]&&!e)return void z(!0);S(!0),z(!1);try{let e=await fetch(`${b.BASE_PATH}/api/students/${N}/generate`,{method:"POST"});if(!e.ok){let a=await e.json();throw Error(a.error||"Erro ao gerar PDF")}let a=await e.blob(),t=window.URL.createObjectURL(a),s=document.createElement("a");s.href=t,s.download=`Declaracao_Matricula_${k["Nome Completo"].replace(/\s+/g,"_")}.pdf`,document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(t),document.body.removeChild(s)}catch(e){alert(e.message||"Erro ao gerar documento")}finally{S(!1)}}};if("loading"===j||A)return(0,a.jsxs)("div",{className:"flex h-[80vh] flex-col items-center justify-center gap-4",children:[(0,a.jsx)(n.Loader2,{className:"h-10 w-10 animate-spin text-primary"}),(0,a.jsx)("p",{className:"text-xs font-bold uppercase tracking-widest text-gray-400",children:"Carregando perfil..."})]});if(M||!k)return(0,a.jsxs)("div",{className:"flex h-[80vh] flex-col items-center justify-center gap-6 animate-in fade-in duration-500",children:[(0,a.jsx)("div",{className:"bg-red-50 p-4 rounded-full",children:(0,a.jsx)(c,{className:"h-12 w-12 text-red-500"})}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-xl font-bold text-gray-900",children:M||"Aluno não encontrado"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Verifique o CPF digitado e tente novamente."})]}),(0,a.jsxs)("button",{onClick:()=>v.push("/busca"),className:"inline-flex items-center gap-2 px-6 py-3 bg-black text-white rounded-full text-sm font-bold hover:bg-gray-900 transition-all active:scale-95",children:[(0,a.jsx)(d,{size:16}),"Voltar para busca"]})]});let L=(t=(k.Turma||k.TURMA||"").toUpperCase(),i=k["Data da matrícula"]||k["Data da Matrícula"]||k["DATA DE MATRÍCULA"],t.includes("5B")?"01/05/2025":t.includes("5A")||t.includes("TURMA 5")?"01/02/2025":i||"-"),P="DISTRATO"===k["Situação Cadastral"];return(0,a.jsxs)("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-12 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-6 mb-12",children:[(0,a.jsxs)(f.default,{href:"/busca",className:"group flex items-center gap-2 text-sm font-bold uppercase tracking-widest text-gray-400 hover:text-primary transition-colors",children:[(0,a.jsx)(d,{size:18,className:"group-hover:-translate-x-1 transition-transform"}),"Voltar para busca"]}),(0,a.jsxs)("button",{onClick:()=>R(),disabled:D||P,className:"w-full sm:w-auto inline-flex items-center justify-center gap-3 rounded-full bg-black px-8 py-4 text-sm font-bold text-white shadow-xl hover:bg-gray-900 active:scale-95 disabled:opacity-20 disabled:pointer-events-none transition-all group overflow-hidden relative",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-primary opacity-0 group-hover:opacity-10 transition-opacity"}),D?(0,a.jsx)(n.Loader2,{className:"animate-spin h-5 w-5"}):(0,a.jsx)(o,{className:"h-5 w-5 text-primary"}),(0,a.jsx)("span",{className:"relative",children:D?"Processando Documento...":"Gerar Declaração de Matrícula"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsxs)("div",{className:"lg:col-span-1 space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-3xl border border-gray-100 p-8 shadow-sm",children:[(0,a.jsx)("div",{className:"h-24 w-24 rounded-2xl bg-gray-50 flex items-center justify-center mb-6",children:(0,a.jsx)("span",{className:"text-4xl font-bold text-gray-200",children:k["Nome Completo"]?.charAt(0)})}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 leading-tight",children:k["Nome Completo"]}),(0,a.jsx)("div",{className:"mt-4 flex flex-col gap-2",children:(0,a.jsx)("span",{className:`inline-flex items-center w-fit px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider ${P?"bg-red-50 text-red-600 border border-red-100":"TRANCADO"===k["Situação Cadastral"]?"bg-amber-50 text-amber-600 border border-amber-100":"bg-green-50 text-green-600 border border-green-100"}`,children:k["Situação Cadastral"]})})]}),(0,a.jsxs)("div",{className:"bg-primary/5 rounded-3xl p-6 border border-primary/10",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 text-primary mb-2",children:[(0,a.jsx)(p,{size:18}),(0,a.jsx)("h4",{className:"text-xs font-bold uppercase tracking-widest",children:"Data Sugerida (PDF)"})]}),(0,a.jsx)("p",{className:"text-2xl font-bold text-primary",children:L}),(0,a.jsx)("p",{className:"text-[10px] text-primary/60 mt-1 uppercase font-medium",children:"Calculado via Regras de Turma"})]})]}),(0,a.jsxs)("div",{className:"lg:col-span-2",children:[(0,a.jsxs)("div",{className:"bg-white rounded-3xl border border-gray-100 shadow-sm overflow-hidden",children:[(0,a.jsx)("div",{className:"px-8 py-6 border-b border-gray-50",children:(0,a.jsx)("h3",{className:"text-xs font-bold uppercase tracking-[0.2em] text-gray-400",children:"Informações Cadastrais"})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2",children:[(0,a.jsx)(y,{icon:(0,a.jsx)(h,{size:18}),label:"Curso",value:k.Curso||k.CURSO||k.sourceSheet}),(0,a.jsx)(y,{icon:(0,a.jsx)(x,{size:18}),label:"Nascimento",value:k["Data de Nascimento"]||k["DATA DE NASCIMENTO"]}),(0,a.jsx)(y,{icon:(0,a.jsx)(m,{size:18}),label:"E-mail",value:k["E-mail"]||k.EMAIL||"-"}),(0,a.jsx)(y,{icon:(0,a.jsx)(u,{size:18}),label:"Telefone",value:k.Telefone||"-"}),(0,a.jsx)(y,{icon:(0,a.jsx)(o,{size:18}),label:"CPF",value:k.CPF}),(0,a.jsx)(y,{icon:(0,a.jsx)(x,{size:18}),label:"Data de Matrícula",value:k["Data da matrícula"]||k["Data da Matrícula"]||k["DATA DE MATRÍCULA"]||"-"})]})]}),P&&(0,a.jsxs)("div",{className:"mt-6 bg-red-50 border border-red-100 rounded-2xl p-6 flex gap-4 animate-in shake-in duration-500",children:[(0,a.jsx)(c,{className:"text-red-500 h-6 w-6 flex-shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-bold text-red-700 uppercase tracking-widest",children:"Restrição de Emissão"}),(0,a.jsx)("p",{className:"text-sm text-red-600 mt-1 font-medium",children:"Este aluno está em status de Distrato. A emissão de documentos oficiais está suspensa permanentemente."})]})]})]})]}),E&&(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>z(!1)}),(0,a.jsxs)("div",{className:"relative bg-white rounded-[2rem] shadow-2xl max-w-md w-full p-10 animate-in zoom-in-95 duration-200 text-center border border-gray-100",children:[(0,a.jsx)("div",{className:"bg-amber-50 h-20 w-20 rounded-3xl flex items-center justify-center mx-auto mb-6 text-amber-500",children:(0,a.jsx)(c,{size:40})}),(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-2 tracking-tight",children:"Aluno com Restrição"}),(0,a.jsxs)("p",{className:"text-gray-500 mb-8 font-medium",children:["A situação cadastral desta conta é ",(0,a.jsxs)("span",{className:"text-amber-600 font-bold",children:['"',k["Situação Cadastral"],'"']}),". Deseja confirmar a geração da declaração?"]}),(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsx)("button",{onClick:()=>R(!0),className:"w-full py-4 text-sm font-bold text-white bg-black rounded-full hover:bg-gray-900 transition-all active:scale-95 shadow-lg shadow-black/10",children:"Confirmar Emissão"}),(0,a.jsx)("button",{onClick:()=>z(!1),className:"w-full py-4 text-sm font-bold text-gray-400 hover:text-gray-600 transition-colors",children:"Cancelar"})]})]})]})]})}function y(e){let s,r,l,i,d=(0,t.c)(10),{icon:o,label:n,value:c}=e;return d[0]!==n?(s=(0,a.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-[0.2em]",children:n}),d[0]=n,d[1]=s):s=d[1],d[2]!==o||d[3]!==s?(r=(0,a.jsxs)("div",{className:"flex items-center gap-3 text-gray-300 mb-2 group-hover:text-primary transition-colors",children:[o,s]}),d[2]=o,d[3]=s,d[4]=r):r=d[4],d[5]!==c?(l=(0,a.jsx)("p",{className:"text-base font-bold text-gray-900 truncate",title:c,children:c}),d[5]=c,d[6]=l):l=d[6],d[7]!==r||d[8]!==l?(i=(0,a.jsxs)("div",{className:"px-8 py-8 border-r border-b border-gray-50 last:border-r-0 group hover:bg-gray-50/50 transition-colors",children:[r,l]}),d[7]=r,d[8]=l,d[9]=i):i=d[9],i}e.s(["default",()=>g],28890)}]);